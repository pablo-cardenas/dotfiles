#!/bin/bash

mkdir -p $HOME/Documents/dev/thesis
cd $HOME/Documents/dev/thesis

if ! tmux has-session -t thesis 2>/dev/null; then
	tmux new-session -s thesis -n main -d

	tmux split-window -h -t thesis
	tmux select-layout -t thesis main-horizontal

	tmux send-keys -t thesis:0.0 'sleep 0.5s; vim --servername thesis -S ~/.vim/session/thesis.vim' C-m
	tmux send-keys -t thesis:0.1 'while sleep 0.5s; do git ls-files --cached --other -X .gitignore | entr -ccds "pdftex -output-directory=/tmp -synctex=1 -interaction=nonstopmode -halt-on-error document.tex | head -n -2" ; done' C-m

	tmux new-window -t thesis -c /usr/local/texlive/2022/ -n texlive

	tmux select-window -t thesis:0
	tmux select-pane -t thesis:0.0
fi

tmux attach -t thesis
git status
