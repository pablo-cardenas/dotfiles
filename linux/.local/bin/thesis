#!/bin/bash -v

mkdir -p $HOME/Documents/dev/thesis
cd $HOME/Documents/dev/thesis

if ! tmux has-session -t thesis; then
	tmux new-session -s thesis -n main -d

	tmux split-window -h -t thesis
	tmux select-layout -t thesis main-horizontal

	tmux send-keys -t thesis:0.0 'vim -S ~/.vim/session/thesis.vim' C-m
	tmux send-keys -t thesis:0.1 'clear; find | entr -c pdftex -output-directory=/tmp -interaction=nonstopmode document.tex' C-m
	setsid zathura /tmp/document.pdf >/dev/null 2>&1 &

	tmux select-window -t thesis:0
	tmux select-pane -t thesis:0.0
fi

tmux attach -t thesis
